{% extends "base.html" %}

{% block content %}
<div class="container" style="max-width: 600px;">
    
    <div style="margin-bottom: 24px; margin-top: 10px;">
        <h1 style="margin: 0; font-size: 28px; font-weight: 800;">{{ t.history }}</h1>
        <p style="color: var(--text-muted); margin: 5px 0 0 0;">Tap an item to see details</p>
    </div>

    {% if history|length == 0 %}
        <div class="card" style="text-align: center; padding: 40px 20px;">
            <div style="font-size: 40px; margin-bottom: 15px; opacity: 0.5;">üìù</div>
            <h3 style="margin: 0 0 10px 0;">No quizzes yet</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">Start a quiz to see your progress here.</p>
            <a href="{{ url_for('main.subjects_page') }}" class="btn-primary" style="display: inline-flex; width: auto; padding: 12px 24px;">Start Learning</a>
        </div>
    {% else %}
        <div style="display: flex; flex-direction: column; gap: 12px;">
            {% for item in history %}
            <details class="history-item">
                <summary class="card" style="margin: 0; padding: 16px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; list-style: none;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="min-width: 40px; height: 40px; border-radius: 12px; 
                                    background: {{ 'rgba(34, 197, 94, 0.1)' if item.is_correct else 'rgba(239, 68, 68, 0.1)' }}; 
                                    color: {{ 'var(--success)' if item.is_correct else 'var(--danger)' }};
                                    display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: bold;">
                            {{ '‚úì' if item.is_correct else '‚úï' }}
                        </div>
                        <div>
                            <div style="font-size: 11px; font-weight: 700; text-transform: uppercase; color: var(--text-muted);">{{ item.subject }}</div>
                            <div style="font-weight: 600; font-size: 14px; margin-top: 2px;">{{ item.question_text[:35] }}...</div>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: var(--text-muted);">{{ item.timestamp.strftime('%d %b') }} ‚ñº</div>
                </summary>

                <div class="card" style="margin-top: -10px; border-top: none; border-radius: 0 0 20px 20px; background: var(--bg-body); border: 1px solid var(--border); padding: 20px;">
                    <p style="font-weight: 600; font-size: 15px; margin-top: 0;">{{ item.question_text }}</p>
                    <div style="margin-bottom: 15px; padding: 10px; border-radius: 8px; background: {{ 'rgba(34, 197, 94, 0.1)' if item.is_correct else 'rgba(239, 68, 68, 0.1)' }}; color: {{ 'var(--success)' if item.is_correct else 'var(--danger)' }}; font-size: 13px; font-weight: 700;">
                        {% if item.is_correct %}
                            You answered correctly!
                        {% else %}
                            Incorrect. <span style="color: var(--text-main); font-weight: 400;">Answer: <b>{{ item.correct_answer }}</b></span>
                        {% endif %}
                    </div>
                    <div style="font-size: 12px; color: var(--text-muted); text-transform: uppercase; font-weight: 700; margin-bottom: 4px;">Explanation</div>
                    <div style="font-size: 14px; line-height: 1.5; color: var(--text-muted);">{{ item.explanation }}</div>
                </div>
            </details>
            {% endfor %}
        </div>
    {% endif %}
</div>
<style>
    details > summary { list-style: none; }
    details > summary::-webkit-details-marker { display: none; }
    details[open] summary { border-bottom-left-radius: 0; border-bottom-right-radius: 0; border-bottom: 1px solid var(--border); }
    details[open] div { animation: slideDown 0.2s ease-out; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
</style>
{% endblock %}