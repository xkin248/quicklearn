{% extends "base.html" %}

{% block content %}
<div class="container" style="max-width: 600px;">
    
    <div style="margin-bottom: 30px; margin-top: 10px;">
        <h1 style="margin: 0; font-size: 28px; font-weight: 800;">{{ t.settings }}</h1>
        <p style="color: var(--text-muted); margin: 5px 0 0 0;">Manage your preferences</p>
    </div>

    <div class="section-title">{{ t.language if t.language else 'Language' }}</div>
    <div class="menu-group">
        <a href="{{ url_for('main.set_language', lang_code='en') }}" class="menu-item">
            <span style="display: flex; align-items: center; gap: 12px;">
                <span style="font-size: 20px;">ðŸ‡ºðŸ‡¸</span> 
                <span style="font-weight: 500;">English</span>
            </span>
            <span>{% if session.get('lang') == 'en' %}âœ“{% endif %}</span>
        </a>
        <a href="{{ url_for('main.set_language', lang_code='bm') }}" class="menu-item">
            <span style="display: flex; align-items: center; gap: 12px;">
                <span style="font-size: 20px;">ðŸ‡²ðŸ‡¾</span>
                <span style="font-weight: 500;">Bahasa Melayu</span>
            </span>
            <span>{% if session.get('lang') == 'bm' %}âœ“{% endif %}</span>
        </a>
    </div>

    <div class="section-title">{{ t.appearance if t.appearance else 'Appearance' }}</div>
    <div class="menu-group">
        <div class="menu-item" style="padding: 16px;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="width: 40px; height: 40px; background: rgba(99, 102, 241, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                    ðŸŒ—
                </div>
                <div style="display: flex; flex-direction: column;">
                    <span style="font-weight: 600; font-size: 16px;">Screen Theme</span>
                    <span id="theme-label" style="font-size: 12px; color: var(--text-muted);">Switch to Light Mode</span>
                </div>
            </div>
            
            <label class="switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="section-title">{{ t.history if t.history else 'History' }}</div>
    <div class="menu-group">
        <a href="{{ url_for('quiz.history') }}" class="menu-item">
            <span style="display: flex; align-items: center; gap: 12px;">
                <span style="font-size: 20px;">â†º</span>
                <span style="font-weight: 500;">{{ t.history }}</span>
            </span>
            <span style="color: var(--text-muted);">â€º</span>
        </a>
    </div>

    <a href="{{ url_for('auth.logout') }}" class="btn-primary" style="background: rgba(239, 68, 68, 0.1); color: #ef4444; margin-top: 20px; border: 1px solid rgba(239, 68, 68, 0.2);">
        {{ t.logout }}
    </a>
    
    <div style="text-align: center; margin-top: 30px; color: var(--text-muted); font-size: 12px;">
        Version 1.0.0
    </div>

</div>

<style>
    .menu-item { 
        display: flex; 
        justify-content: space-between; 
        align-items: center;
        padding: 16px; 
        background: var(--bg-card); 
        border-bottom: 1px solid var(--border); 
        text-decoration: none; 
        color: var(--text-main); 
        transition: background 0.2s;
    }
    .menu-item:last-child { border-bottom: none; }
    .menu-item:active { background: rgba(255,255,255,0.05); }

    .menu-group { 
        border-radius: 20px; 
        overflow: hidden; 
        margin-bottom: 24px; 
        border: 1px solid var(--border); 
        background: var(--bg-card);
    }
    
    .section-title { 
        font-size: 13px; 
        font-weight: 700; 
        color: var(--text-muted); 
        margin: 0 0 8px 12px; 
        text-transform: uppercase; 
        letter-spacing: 0.5px;
    }

    /* Toggle Switch Style */
    .switch { position: relative; display: inline-block; width: 52px; height: 30px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { 
        position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; 
        background-color: #334155; transition: .4s; border-radius: 34px; 
    }
    .slider:before { 
        position: absolute; content: ""; height: 22px; width: 22px; 
        left: 4px; bottom: 4px; background-color: white; 
        transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    input:checked + .slider { background-color: var(--primary); }
    input:checked + .slider:before { transform: translateX(22px); }
</style>

<script>
    const toggle = document.getElementById('theme-toggle');
    const themeLabel = document.getElementById('theme-label');
    const currentTheme = localStorage.getItem('theme') || 'dark'; // Default to dark
    
    // Set initial state
    if (currentTheme === 'light') {
        toggle.checked = true;
        themeLabel.innerText = "Switch to Dark Mode";
    } else {
        toggle.checked = false;
        themeLabel.innerText = "Switch to Light Mode";
    }

    // Handle Click
    toggle.addEventListener('change', function(e) {
        if (e.target.checked) {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
            themeLabel.innerText = "Switch to Dark Mode";
        } else {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
            themeLabel.innerText = "Switch to Light Mode";
        }
    });
</script>
{% endblock %}